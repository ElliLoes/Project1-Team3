<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>

<body>

    <button id="buttonFillStorage">fill</button>
    <button id="buttonClearStorage">clear</button>
    <button id="buttonAJAXCategories">AJAX CATEGORIES</button>


    <script>
        let keyStorageUserRestaurants = 'chow_town_user_restaurants';
        let keyStorageTrips = 'chow_town_trips';


        let arrUserRestaurantsForStorage = [
            {
                restaurant_id: 'restaurant_a',
                image_url: './scripts/chicken.png',
                name: 'Restaurant A',
                location: 'Sydney',
                price: '$',
                categories: 'Seafood',
                rating: 2,
                url: 'https://www.yelp.com.au/biz/belles-hot-chicken-barangaroo?osq=chicken'
            },
            {
                restaurant_id: 'restaurant_b',
                image_url: './scripts/chicken.png',
                name: 'Restaurant B',
                location: 'Newcastle, Australia',
                price: '$$',
                categories: 'Pizza',
                rating: 3.3,
                url: 'https://www.yelp.com.au/biz/belles-hot-chicken-barangaroo?osq=chicken'
            },
            {
                restaurant_id: 'restaurant_c',
                image_url: './scripts/chicken.png',
                name: 'Restaurant C',
                location: 'Bondi, Sydney',
                price: '$$$',
                categories: 'Barbeque',
                rating: 5,
                url: 'https://www.yelp.com.au/biz/belles-hot-chicken-barangaroo?osq=chicken'
            },
            {
                restaurant_id: 'restaurant_d',
                image_url: './scripts/chicken.png',
                name: 'Restaurant D',
                location: 'Parramatta, Sydney',
                price: '$',
                categories: 'Deep Fried',
                rating: 4.3,
                url: 'https://www.yelp.com.au/biz/belles-hot-chicken-barangaroo?osq=chicken'
            }
        ];
        let arrTripsForStorage = [
            {
                trip_id: 'TRIP1',
                trip_name: 'HUNGRY DAYS',
                restaurant_ids: ['restaurant_a', 'restaurant_b', 'restaurant_c']
            },
            {
                trip_id: 'TRIP2',
                trip_name: 'FOOD COMA',
                restaurant_ids: ['restaurant_a', 'restaurant_b']
            },
            {
                trip_id: 'TRIP3',
                trip_name: 'FRIED CHICKEN EVERY DAY',
                restaurant_ids: ['restaurant_b', 'restaurant_c', 'restaurant_d']
            }
        ];

        // keyStorageUserRestaurants
        // keyStorageTrips

        let buttonFillStorage = document.querySelector('#buttonFillStorage');
        buttonFillStorage.addEventListener('click', function () {
            localStorage.setItem(keyStorageUserRestaurants, JSON.stringify(arrUserRestaurantsForStorage));
            localStorage.setItem(keyStorageTrips, JSON.stringify(arrTripsForStorage));
        });
        let buttonClearStorage = document.querySelector('#buttonClearStorage');
        buttonClearStorage.addEventListener('click', function () {
            localStorage.clear();
        });




























        let keyStorageCATEGORIES = 'chow_town_categories';
        let arrCategories = [];
        arrCategories = JSON.parse(localStorage.getItem(keyStorageCATEGORIES));

        $('#buttonAJAXCategories').on('click', function () {
            $.ajax({
                url: 'https://cors-anywhere.herokuapp.com/https://api.yelp.com/v3/categories',
                method: 'GET',
                headers: {
                    'Authorization': 'Bearer YD2lcCavl5yda52nTX1wKG-uHD-BRa_9izM0BLTdtg0nvbPe5j81Y9WNLsFEhnCZtOGUH2kbC4f06c7Cdw5UwR4-HJvPJtMf0izr-79DSXBaDzHpWQ3ljZJs9RiAXXYx'
                }
            }).then(function (response) {
                // console.log(response.categories.length);
                // console.log(response);
                localStorage.setItem(keyStorageCATEGORIES, JSON.stringify(response.categories));
                arrCategories = JSON.parse(localStorage.getItem(keyStorageCATEGORIES));
                console.log(arrCategories);
            });
        });



        
        
        let keyStorageCATEGORIESFILTERED = 'chow_town_categories_filtered';
        let arrCategoriesFiltered = [];
        
        
        // console.log(arrCategories);
        runFilter();
        function runFilter() {
            let arrAppendedParents = ['food', 'restaurants'];
            
            // for (let i = 0; i < arrCategories.length; i++) {
            for (let i = 0; i < 300; i++) {

                // if (arrCategories[i].parent_aliases.length == 0) {
                //     console.log(arrCategories[i]);

                //// only results worth looking at are 'food' and 'restaurants'
                // }
                if (arrCategories[i].parent_aliases.length == 1) {
                    if (arrCategories[i].parent_aliases[0] == 'food' || arrCategories[i].parent_aliases[0] == 'restaurants') {
                        // console.log(arrCategories[i]);
                        arrCategoriesFiltered.push(arrCategories[i]);
                    }
                }
                if (arrCategories[i].parent_aliases.length == 2) {
                    if (arrCategories[i].parent_aliases[0] == 'food' || arrCategories[i].parent_aliases[1] == 'food' || arrCategories[i].parent_aliases[0] == 'restaurants' || arrCategories[i].parent_aliases[1] == 'restaurants') {
                        // console.log(arrCategories[i]);
                    }
                }
            }
        }
        console.log(arrCategoriesFiltered);

        // localStorage.setItem(keyStorageCATEGORIESFILTERED, JSON.stringify(arrCategoriesFiltered));
        // arrCategoriesFiltered = JSON.parse(localStorage.getItem(keyStorageCATEGORIESFILTERED));


        //find all food
        //find all restaurants
        //
    </script>
</body>

</html>